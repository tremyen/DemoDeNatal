01 ' ---------------
02 ' Crazy Santa 
03 ' Uma Demo de Natal por Manoel Neto 2021-12-12
04 ' ---------------	
10 KEY OFF : SCREEN 3,2,0         : ' SETA A TELA PARA O MODO GRAFICO 
20 COLOR 15,8,8                   : ' SETA AS CORES DA TELA 
30 CLS               			  : ' LIMPA A TELA 
40 OPEN "GRP:" FOR OUTPUT AS #1   : ' ABRE A SCREEN 2 PARA ESCRITA
50 GOSUB 10000                    : ' CARREGA OS DADOS DOS SPRITES NA RAM
60 GOSUB 200                      : ' DESENHA SPLASH SCREEN
70 CLS 
80 VD% = 1 : CR% = 0              : ' VIDAS E CRIANCAS RESGATADAS
85 GM% = 1                        : ' DETERMINA MOVIMENTO DO GRINCH
90  GOSUB 500                     : ' CRIAR ARVORE
100 GOSUB 600                     : ' CRIAR GRINCH
110 GOSUB 700                     : ' CRIAR PAPAI NOEL 
120 GOSUB 800                      : ' COMECAO O LOOP DO JOGO
130 GOSUB 1000                    : ' FINAL DE JOGO
140 END 

200 ' ---------------
201 '  DESENHAR A SPLASH SCREEN
202 ' ---------------
250 ON INTERVAL = 1000 GOSUB 9000  : ' INICIA A MUSICA
260 INTERVAL ON                    : ' INICIA AS INTERRUPCOES
270 PRESET(55,70) : PRINT#1,"Feliz": ' MENSAGEM INICIAL 
280 PRESET(55,120): PRINT#1,"Natal"
285 GOSUB 9000
290 XP% = -16 : YP% = 40           : ' COORDENADAS DO PAPAI NOEL 
300 XA% = 240 : YA% = 160          : ' COORDENADAS DA ARVORE 
310 XG% = 255 : YG% = 160          : ' COORDENADAS DO GRINCH
330 ' LOOPA ATE PRESSIONAR ESPACO 
340   IF XP% > 255 THEN XP% = -16
350   IF XG% < -16 THEN XG% = 255
360   IF XA% < -16 THEN XA% = 255     
370   GOSUB 2000
380   GOSUB 3000
390   GOSUB 4000 
400   XP% = XP% + 1
410   XG% = XG% - 1 
420   XA% = XA% - 1
430   IF STRIG(0)=0 THEN GOTO 330 
440 INTERVAL OFF
450 RETURN

500 ' --------------- 
501 ' CRIAR ARVORE 
502 ' ---------------
510 T=RND(-TIME)
520 XA% = INT(RND(1)*240+1) 
530 YA% = INT(RND(1)*180+1) 
540 GOSUB 2000
550 RETURN 

600 ' ---------------
601 ' CRIAR O GRINCH
602 ' ---------------
610 XG% = 20 
620 YG% = 20 
630 GOSUB 4000
640 RETURN 

700 ' ---------------
701 ' CRIAR O NOEL
702 ' ---------------
710 XP% = 120 
720 YP% = 90 
730 GOSUB 3000
740 RETURN 

800 ' ---------------
801 ' LOOP DO JOGO 
802 ' ---------------
810 ST%=STICK(0)                    : ' PEGA A ENTRADA DO JOGADOR
820 IF ST% = 1 THEN YP% = YP% + 16
830 IF ST% = 3 THEN XP% = XP% + 16
840 IF ST% = 5 THEN YP% = YP% - 16
850 IF ST% = 7 THEN XP% = XP% - 16
860 GOSUB 3000
865 xG% = XG%+(GM%):YG%= YG%+(GM%)
867 GOSUB 4000   
870 ON SPRITE GOSUB 5000            : ' CHECAR COLISAO 
860 IF VD% = 0 THEN RETURN          : ' FINAL DO JOGO 
870 GOTO 810 

1000 ' ---------------
1001 ' FIM DO JOGO  
1002 ' ---------------
1006 SCREEN 2,2,0
1010 CLS
1020 PRESET(50,80) : PRINT#1,"Voce Salvou o Natal"
1030 PRESET(60,110): PRINT#1,"De "+STR$(CR%)+" Criancas!"
1060 IF STRIG(0)=0 THEN GOTO 1060   
1090 RETURN 

2000 ' ---------------
2001 ' ADICIONAR SPRITE DE ARVORE 
2002 ' ---------------
2010 PUT SPRITE 0,(XA%,YA%),2,0 
2020 PUT SPRITE 1,(XA%,YA%),6,1
2030 RETURN

3000 ' ---------------
3001 ' ADICIONAR SPRITE DE PAPAI NOEL 
3002 ' ---------------
3010 PUT SPRITE 2,(XP%,YP%),1,2 
3020 PUT SPRITE 3,(XP%,YP%),6,3 
3030 PUT SPRITE 4,(XP%,YP%),10,4 
3040 PUT SPRITE 5,(XP%,YP%),15,5
3050 RETURN

4000 ' ---------------
4001 ' ADICIONAR SPRITE DO GRINCH
4002 ' ---------------
4010 PUT SPRITE 6,(XG%,YG%),1,6
4020 PUT SPRITE 7,(XG%,YG%),2,7 
4030 RETURN

5000 ' ---------------
5001 ' CHECAR COLISAO 
5002 ' ---------------
5010 VD% = VD% - 1
5990 RETURN

9000 ' ---------------
9001 ' MUSICA DE NATAL
9002 ' ---------------
9010 A$="T140V12o4cf8r8f8g8f8e8d8r8d8r8dg8r8g8a8g8f8e8r8eca8r8a8b-8a8g8f8r8fd16r16d8cft126ee8f2"
9020 PLAY A$
9030 RETURN 

10000 ' ---------------
10010 ' SPRITES
10020 ' ---------------
10040 DATA 01,03,07,03,07,0F,1F,0F,1F,3F,1F,3F,7F,FE,FC,00
10050 DATA 80,C0,E0,C0,E0,F0,F8,F0,F8,FC,F8,FC,FE,7F,3F,00
10060 DATA 00,00,00,00,00,00,00,00,00,00,00,00,00,01,03,01
10070 DATA 00,00,00,00,00,00,00,00,00,00,00,00,00,80,C0,80
10080 DATA 01,03,06,0C,18,10,10,12,10,10,12,09,08,0C,06,03
10090 DATA F0,18,6C,37,19,09,0F,48,08,08,48,90,30,20,60,C0
10100 DATA 00,00,01,03,04,0F,00,00,00,00,00,00,00,00,00,00
10110 DATA 00,E0,90,C8,20,F0,00,00,00,00,00,00,00,00,00,00
10120 DATA 00,00,00,00,00,00,00,05,07,00,00,00,00,00,00,00
10130 DATA 00,00,00,00,00,00,00,A0,E0,00,00,00,00,00,00,00
10140 DATA 00,00,00,00,03,00,0F,08,08,0F,0D,06,07,03,01,00
10150 DATA 00,00,00,00,C6,06,F0,10,10,F0,B0,60,C0,C0,80,00
10160 DATA 00,03,02,02,06,0C,18,36,66,50,62,50,67,28,30,1F
10170 DATA 00,80,80,80,C0,60,30,D8,CC,14,8C,14,CC,2C,18,F0
10180 DATA 00,00,01,01,01,03,07,09,19,2F,1D,2F,18,17,0F,00
10190 DATA 00,00,00,00,00,80,C0,20,30,E8,70,E8,30,D0,E0,00
10200 DATA *

13000 ' --------------- 
13001 ' CARREGAR SPRITES NA VRAM
13002 ' --------------- 
13010 S=BASE(9)
13020 READ R$
13030 IF R$="*" THEN RETURN 
13040 VPOKE S,VAL("&H"+R$)
13050 S=S+1
13060 GOTO 13020 